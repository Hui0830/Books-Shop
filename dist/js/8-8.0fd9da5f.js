(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{317:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return u}),a.d(t,"c",function(){return d}),a.d(t,"b",function(){return p});var r=a(330),n=a.n(r),o=a(101),l=a(320),i=a(51),s=(a(52),e.env.API_BASE||"http://3be1627f.ngrok.io"),c=function(e,t){t=t||{};var a=Object.keys(t).reduce(function(e,a){return e+=a+"="+t[a]+"&"},"");return""+s+e+"?"+a.substr(0,a.length-1)},u=function(e,t){return new Promise(function(a,r){n.a.get(c(e,t)).then(function(e){var t=e.data;t&&"成功"===t.msg?a(t):r(t)}).catch(r)})},d=function(e,t){return new Promise(function(a,r){n.a.post(c(e,t)).then(function(e){var t=e.data;t&&"成功"===t.msg?a(t):r(t)}).catch(r)})},p=function(e,t){return new Promise(function(a,r){i.a.dispatch(Object(l.b)("login")),n.a.post(c(e,t)).then(function(e){var t=e.data;t&&0===t.code?(i.a.dispatch(Object(o.a)()),i.a.dispatch(Object(l.c)("login",t)),a(t),console.log("login_in",t)):(i.a.dispatch(Object(o.b)()),i.a.dispatch(Object(l.a)("login",t)),r(t))}).catch(function(e){console.log("login_out",e),i.a.dispatch(Object(o.b)()),i.a.dispatch(Object(l.a)("login",e)),r(e)})})}}).call(this,a(326))},320:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"c",function(){return o}),a.d(t,"a",function(){return l});var r=a(35),n=(a(317),function(e){return{type:e+"_"+r.b}}),o=function(e,t){return{type:e+"_"+r.c,result:t}},l=function(e,t){return{type:e+"_"+r.a,error:t}}},589:function(e,t,a){"use strict";a.r(t);a(329);var r=a(601),n=(a(366),a(596)),o=a(1),l=a.n(o),i=a(0),s=a.n(i),c=(a(73),a(67)),u=(a(365),a(592)),d=(a(391),a(594)),p=(a(143),a(297)),m=(a(100),a(598)),f=(a(72),a(15)),h=(a(390),a(595)),b=(a(142),a(98)),g=r.a.Item,y=b.a.Option,v=(h.a.Button,h.a.Group),w=function(e){var t=e.form,a=e.loading,n=e.handleSubmit,o=e.validateToNextPassword,i=e.residences,s=e.compareToFirstPassword,w=e.handleConfirmBlur,E=t.getFieldDecorator,O=E("prefix",{initialValue:"86"})(l.a.createElement(b.a,{style:{width:70}},l.a.createElement(y,{value:"86"},"+86"),l.a.createElement(y,{value:"87"},"+87")));return l.a.createElement(r.a,{onSubmit:n,style:{margin:"10px auto",padding:"0 100px"}},l.a.createElement(g,{label:"手机号码",hasFeedback:!0},E("tel",{rules:[{required:!0,message:"请输入正确的手机号码!",pattern:/^[1][3,4,5,7,8][0-9]{9}$/}]})(l.a.createElement(m.a,{addonBefore:O,prefix:l.a.createElement(f.a,{type:"phone",style:{color:"rgba(0,0,0,.25)"}}),style:{width:"100%"}}))),l.a.createElement(g,{hasFeedback:!0,label:l.a.createElement("span",null,"昵称",l.a.createElement(p.a,{title:"您的用户名?"},l.a.createElement(f.a,{type:"question-circle-o"})))},E("username",{rules:[{required:!0,message:"记得给自己取个名字哦!",whitespace:!0}]})(l.a.createElement(m.a,{prefix:l.a.createElement(f.a,{type:"idcard",style:{color:"rgba(0,0,0,.25)"}})}))),l.a.createElement(g,{label:"密码",hasFeedback:!0},E("password",{rules:[{required:!0,message:"密码必须为6~20位的非中文字符哦!",min:6,max:20},{validator:o}]})(l.a.createElement(m.a,{type:"password",prefix:l.a.createElement(f.a,{type:"key",style:{color:"rgba(0,0,0,.25)"}})}))),l.a.createElement(g,{label:"确认密码",hasFeedback:!0},E("password2",{rules:[{required:!0,message:"请再次输入密码!"},{validator:s}]})(l.a.createElement(m.a,{type:"password",onBlur:w,prefix:l.a.createElement(f.a,{type:"key",style:{color:"rgba(0,0,0,.25)"}})}))),l.a.createElement(g,{label:"学校",hasFeedback:!0},E("school",{initialValue:["江西","江西农业大学"],rules:[{type:"array",required:!0,message:"告诉大家你在哪里哦!"}]})(l.a.createElement(d.a,{options:i}))),l.a.createElement(g,{label:"性别",labelCol:{span:4},wrapperCol:{span:20},style:{textAlgin:"left"}},E("sex",{rules:[{required:!0,message:"确认你的性别哦!"}]})(l.a.createElement(v,null,l.a.createElement(h.a,{value:"man"},"男"),l.a.createElement(h.a,{value:"woman"},"女")))),l.a.createElement(g,null,E("agreement",{valuePropName:"checked"})(l.a.createElement(u.a,null,"I have read the ",l.a.createElement("a",{href:""},"agreement")))),l.a.createElement(g,null,l.a.createElement(c.a,{loading:a,type:"primary",htmlType:"submit",style:{width:"100%"}},"注册")))},E=a(317),O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};a(302);var P=[{value:"江西",label:"江西",children:[{value:"江西农业大学",label:"江西农业大学"},{value:"江西财经大学",label:"江西财经大学"},{value:"江西南昌大学",label:"江西南昌大学"}]},{value:"北京",label:"北京",children:[{value:"北京大学",label:"北京大学"},{value:"清华大学",label:"清华大学"},{value:"北京工业大学",label:"北京工业大学"}]}],x=function(e){function t(a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,a));return r.state={confirmDirty:!1,messageShow:!1,loading:!1},r.handleSubmit=r.handleSubmit.bind(r),r.compareToFirstPassword=r.compareToFirstPassword.bind(r),r.validateToNextPassword=r.validateToNextPassword.bind(r),r.handleConfirmBlur=r.handleConfirmBlur.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.handleSubmit=function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,a){if(!e){var r=a.school,o=r[0],l=r[1];delete a.school,t.setState({loading:!0}),console.log(JSON.stringify(O({city:o,school:l},a))),Object(E.c)("/mall/user/user/register",JSON.parse(JSON.stringify(O({city:o,school:l},a)))).then(function(e){t.setState({loading:!1}),t.context.router.history.replace("/login")}).catch(function(e){t.setState({loading:!1}),n.a.error(""+e.msg),console.log(o,l,e)}),console.log("Received values of form: ",a)}})},t.prototype.handleConfirmBlur=function(e){var t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})},t.prototype.compareToFirstPassword=function(e,t,a){var r=this.props.form;t&&t!==r.getFieldValue("password")?a("Two passwords that you enter is inconsistent!"):a()},t.prototype.validateToNextPassword=function(e,t,a){var r=this.props.form;t&&this.state.confirmDirty&&r.validateFields(["confirm"],{force:!0}),a()},t.prototype.render=function(){var e=this.state,t=(e.autoCompleteResult,e.loading);return l.a.createElement("div",{className:"login_bg bg_img"},l.a.createElement("div",{className:"loginContainer"},l.a.createElement("h3",null,"欢迎注册旧书街"),l.a.createElement(w,{loading:t,form:this.props.form,handleSubmit:this.handleSubmit,handleConfirmBlur:this.handleConfirmBlur,compareToFirstPassword:this.compareToFirstPassword,validateToNextPassword:this.validateToNextPassword,residences:P})))},t}(o.Component);x.contextTypes={router:s.a.object};var S=r.a.create()(x);t.default=S}}]);